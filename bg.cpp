//============================================
//
// タイトル:	 未来創造展チーム204
// プログラム名: bg.cpp
// 作成者:		 HAL東京ゲーム学科　劉南宏
// 作成日:       2016/12/07
//
//============================================

//============================================
//インクルードファイル
//============================================
#include "main.h"
#include "bg.h"
#include "manager.h"
#include "input.h"
//============================================
// マクロ定義
//============================================

//=============================================================================
// 構造体定義
//=============================================================================


//=============================================================================
//コンストラクタ
//=============================================================================
CBg::CBg()
{

}

//=============================================================================
//デストラクタ
//=============================================================================
CBg::~CBg()
{
	
}


//=============================================================================
// 背景の初期化処理
//=============================================================================
HRESULT CBg::Init(void)
{
	return S_OK;
}

HRESULT CBg::Init(D3DXVECTOR3 pos, D3DXVECTOR3 size, float speed)
{
	CScene2D::Init( pos, size);
	
	m_scroll = D3DXVECTOR2( 0.0f, 0.0f);
	m_fSpeed = speed;

	return S_OK;
}

//=============================================================================
// 背景の終了処理
//=============================================================================
void CBg::Uninit(void)
{
	CScene2D::Uninit();
}


//=============================================================================
// 背景の更新処理
//=============================================================================
void CBg::Update(void)
{
	CInputKeyboard *pInputKeyboard = CManager::GetInputKeyboard();

	m_scroll.y -= m_fSpeed;

	//移動
	if(pInputKeyboard->GetKeyPress(DIK_A))
	{
		m_scroll.x -= m_fSpeed;
	}
	if(pInputKeyboard->GetKeyPress(DIK_D))
	{
		m_scroll.x += m_fSpeed;
	}
	
	SetScroll( m_scroll);
}

//=============================================================================
// 背景の描画処理
//=============================================================================
void CBg::Draw(void)
{
	CScene2D::Draw();
}

//=============================================================================
// 背景の生成処理
//=============================================================================
CBg *CBg::Create(D3DXVECTOR3 pos, D3DXVECTOR3 size, LPCSTR strFileName, float speed)
{
	CBg *pBg;
	pBg = new CBg;
	pBg->Init(pos, size, speed);

	//テクスチャの読み込み
	pBg->Load( strFileName);

	return pBg;
}
//=============================================================================
// スクロール
//=============================================================================
void CBg::SetScroll(D3DXVECTOR2 scroll)
{
	D3DXVECTOR2 tex[4];

	tex[0] = D3DXVECTOR2(scroll.x + 0.0F, scroll.y + 0.0F);
	tex[1] = D3DXVECTOR2(scroll.x + 1.0F, scroll.y + 0.0F);
	tex[2] = D3DXVECTOR2(scroll.x + 0.0F, scroll.y + 1.0F);
	tex[3] = D3DXVECTOR2(scroll.x + 1.0F, scroll.y + 1.0F);

	this->SetTexture( tex[0], tex[1], tex[2], tex[3]);
}
